CREATE OR REPLACE DIRECTORY LOUISIANA AS 'D:\Spatial Dhaval';

DROP TABLE States;

CREATE TABLE States(Capital varchar(15),Coordinates varchar(21), Flag BLOB, Report CLOB,Famous_Novel varchar(50),Famous_Tourist_Site varchar(100), SHAPE MDSYS.SDO_GEOMETRY);

DELETE FROM USER_SDO_GEOM_METADATA WHERE TABLE_NAME = 'STATES' AND COLUMN_NAME='SHAPE';

INSERT INTO USER_SDO_GEOM_METADATA (TABLE_NAME, COLUMN_NAME, DIMINFO, SRID) VALUES ('STATES', 'SHAPE', MDSYS.SDO_DIM_ARRAY (MDSYS.SDO_DIM_ELEMENT('X', -180.000000000, 180.000000000, 0.500000000), MDSYS.SDO_DIM_ELEMENT('Y', -90.000000000, 90.000000000, 0.500000000)), 8307); 

CREATE INDEX states_spatial_idx on States(SHAPE) INDEXTYPE IS MDSYS.SPATIAL_INDEX;

INSERT INTO States(Capital, Coordinates, Flag, Report, Famous_Novel, Famous_Tourist_Site, Shape) VALUES ('Baton Rouge', '30.9843,-91.9623', EMPTY_BLOB(),'The state of Louisiana has parishes instead of counties. A large population of Cajuns resides in this state. There is a bridge named Lake Pontchartrain Causeway in Louisiana which is the worlds longest bridge over a body of water. Louisiana is also known as the birthplace of Jazz. Louisiana state capitol building is the tallest in the United States at about 450 feet. It is also one of Americas greatest salt producers. There is a world-famous event being held in New Orleans called Mardi Gras. Mausoleums are often used instead of traditional underground graves because most of the New Orleans sits below sea level. The first opera performed in the U.S. took place in the French Quarter of New Orleans in the year 1796. Louisiana is home to both the Crawfish Capital of the World and the Frog Capital of the World. Saint Charles streetcar located in New Orleans is one of the only two mobile national monuments in the country.','The Awakening by Kate Chopin','The National WWII Museum emphasizing the American experience in World War II.',SDO_GEOMETRY(7, 8307, NULL, SDO_ELEM_INFO_ARRAY(1, 3, 1), SDO_ORDINATE_ARRAY(-93.707359, 30.239372, -93.699211, 30.297388, -93.729774, 30.304916, -93.759178, 30.340872, -93.759338, 30.354145, -93.747833,30.367411, -93.754944, 30.381788, -93.742561, 30.408823, -93.721535, 30.43298, -93.696571, 30.442633, -93.703423, 30.462513, -93.697975, 30.470047, -93.714851,30.488628, -93.707275, 30.496241, -93.714638, 30.505114, -93.70546, 30.522858, -93.735306, 30.545517, -93.71788,
 30.568153, -93.717812, 30.587379, -93.69342, 30.598835, -93.671585, 30.597832, -93.692696, 30.615795, -93.684586, 30.623425, -93.692879, 30.640041, -93.677971, 30.639692, -93.659988, 30.672859, -93.617607, 30.686802, -93.612411, 30.710329, -93.61779, 30.732548, -93.607651, 30.73201, -93.618454, 30.745789, -93.585175, 30.772184, -93.581871, 30.80204, -93.550682, 30.828344, -93.555641, 30.842342, -93.566444, 30.845148, -93.552803, 30.860283, -93.560844, 30.87188, -93.568497, 30.886234, -93.564476, 30.901932, -93.546516, 30.905334, -93.549622, 30.924885, -93.529984, 30.926971, -93.52562, 30.93582, -93.532188, 30.960732, -93.537338, 30.956884, -93.548676, 30.97019, -93.572456, 30.976177, -93.560951, 30.99169, -93.570847, 30.997271, -93.567894, 31.012924, -93.564941, 31.018063, -93.547119, 31.014141, -93.507217, 31.038908, -93.525742, 31.05698, -93.516998, 31.074671, -93.544106, 31.082373, -93.543121, 31.094751, -93.559982, 31.100536, -93.556679, 31.109343, -93.535088, 31.116072, -93.528091, 31.125925, -93.537506, 31.132441, -93.544189, 31.159166, -93.528328, 31.162943, -93.537018, 31.17634, -93.526932, 31.178076, -93.528923, 31.185774, -93.550591, 31.190929, -93.576942, 31.17214, -93.593941, 31.180199, -93.602921, 31.199066, -93.590546, 31.229687, -93.611, 31.242188, -93.611877, 31.270033, -93.616455, 31.275805, -93.630829, 31.273903, -93.645592, 31.290262, -93.656128, 31.286671, -93.681587, 31.312679, -93.67704, 31.328386, -93.634857, 31.373827, -93.661072, 31.372395, -93.664017, 31.398329, -93.687492, 31.40613, -93.694443, 31.415922, -93.696129, 31.427736, -93.687004, 31.438131, -93.701927, 31.446251, -93.698418, 31.461458, -93.726784, 
 31.459475, -93.751244, 31.4855, -93.750435, 31.490557, -93.718994, 31.495403, -93.705795, 31.520569, -93.731659, 31.521877, -93.747543, 31.537718, -93.763306, 31.530724, -93.780128, 31.533735, -93.810516, 31.559063, -93.816322, 31.57711, -93.832619, 31.590183, -93.835579, 31.615189, -93.819588, 31.618092, -93.814728, 31.647966, -93.806427, 31.653767, -93.811844, 31.674566, -93.792267, 31.711395, -93.808769, 31.707565, -93.814949, 31.712351, -93.80999, 31.730352, -93.831161, 31.753281, -93.822067, 31.774637, -93.834328, 31.802017, -93.864822, 31.817272, -93.877403, 31.850113, -93.881264, 31.87142, -93.892525, 31.870066, -93.899261, 31.894455, -93.923462, 31.892593, -93.917923, 31.909702, -93.93573, 31.909456, -93.969986, 31.923164, -93.977211, 31.946159, -94.004395, 31.977942, -94.009888, 31.989134, -94.035065, 31.994513, -94.034767, 32.199448, -94.035233, 32.389225, -94.040199, 32.694813, -94.041603, 32.882347, -94.03875, 33.023289, -93.809753, 33.022594, -93.511742, 33.021152, -93.478897, 33.021393, -93.232376, 33.019238, -92.978828, 33.018135, -92.717079, 33.016701, -92.063309, 33.010025, -91.454353, 33.013874, -91.427528, 33.01342, -91.254616, 33.013477, -91.162132, 33.013039, -91.161865, 33.000294, -91.20916, 32.935852, -91.198311, 32.914162, -91.169701, 32.905022, -91.137177, 32.917786, -91.129936, 32.937466, -91.132355, 32.975224, -91.111816, 32.98735, -91.092674, 32.987621, -91.075592, 32.953712, -91.079529, 32.877163, -91.142151, 32.841213, -91.156342, 32.76268, -91.136467, 32.751125, -91.09771, 32.749397, -91.059029, 32.723518, -91.139557, 32.663174, -91.146263, 32.644852, -91.110992, 32.597527, -91.063812, 32.606388, -91.04763, 
 32.614353, -91.027466, 32.641502, -91.007881, 32.642673, -90.996132, 32.625977, -90.998657, 32.615467, -91.032326, 32.582672, -91.058868, 32.576389, -91.073265, 32.561611, -91.063087, 32.54216, -90.995071, 32.511642, -90.99205, 32.495281,-91.019684, 32.490814, -91.037201, 32.496956, -91.088783, 32.548637, -91.118744, 32.524067, -91.117683, 32.498569, -91.05851, 32.446999, -91.026909, 32.442417,-90.98745, 32.452965, -90.965485, 32.440037, -90.969986, 32.419018, -91.009209,32.397083, -90.998863, 32.366234, -90.984566, 32.356396, -90.914925, 32.345898,-90.885155, 32.381355, -90.875351, 32.37965, -90.916374, 32.305317, -90.929245,32.297405, -90.971657, 32.303699, -90.980766, 32.297653, -90.983818, 32.287132,-90.971016, 32.269066, -90.977219, 32.223404, -91.041649, 32.249439, -91.062462, 32.232742, -91.087914, 32.232388, -91.100571, 32.214886, -91.115952, 32.225605, -91.157265, 32.205864, -91.166847, 32.171989, -91.15654, 32.144783, -91.108711, 32.134991, -91.083008, 32.148579, -91.054047, 32.134392, -91.045311, 32.158672, -91.054474, 32.184532, -91.024414, 32.169899, -91.00383, 32.169262, -91.011284, 32.13406, -91.041084, 32.10767, -91.073814, 32.093994, -91.06501, 32.058552, -91.089302, 32.056843, -91.125618, 32.088245, -91.145584, 32.085674, -91.143013, 32.066105, -91.086884, 32.043655, -91.073135, 32.031994, -91.07238, 32.021057, -91.108002, 31.991827, -91.163033, 31.988291, -91.201431, 31.914289, -91.24437, 31.878511, -91.26458, 31.865425, -91.241272, 31.835226, -91.250618, 31.818659, -91.276688, 31.827372, -91.292534, 31.861332, -91.30336, 31.862984, -91.334732, 31.843317, -91.347122, 31.79567, -91.36702, 31.770704, -91.336143, 
 31.763458, -91.262573, 31.773764, -91.263878, 31.7596, -91.282509, 31.749723, -91.339798, 31.758379, -91.370384, 31.753311, -91.36496, 31.751577, -91.387833, 31.716518, -91.389069, 31.65444, -91.408287, 31.625364, -91.45726, 31.626801, -91.49765, 31.65073, -91.50769, 31.643705, -91.508759, 31.62178, -91.497032, 31.604193, -91.415268,31.602427, -91.404137, 31.586187, -91.423462, 31.56258, -91.464355, 31.5427, -91.502838, 31.534714, -91.506363, 31.52552, -91.507782, 31.452915, -91.473175, 31.420206, -91.465805, 31.4039, -91.480721, 31.377611, -91.494591, 31.37508, -91.522896, 31.391922, -91.53405, 31.409069, -91.534683, 31.434166, -91.552353, 31.43293, -91.567612, 31.421236, -91.559258, 31.38806, -91.534454, 31.38258, -91.544289, 31.368704, -91.542671, 31.346815, -91.505638, 31.323286, -91.502357, 31.298687, -91.51696, 31.282898, -91.556801, 31.270296, -91.634094, 31.277519, -91.643562, 31.270943, -91.636879, 31.240929, -91.600845, 31.213755, -91.59137, 31.178307, -91.619995, 31.127518, -91.564857, 31.081959, -91.551964, 31.057983, -91.57267, 31.032471, -91.627655, 31.011782, -91.632179, 31.001186, -91.1791, 31.000284,-91.056908, 31.00024, -90.829613, 31.001368, -90.560158, 31.001528, -90.542557,31.002151, -90.343567, 31.005211, -90.259285, 31.007191, -89.833481, 31.007002,-89.732643, 31.007261, -89.723549, 31.001341, -89.726707, 30.984432, -89.719749, 30.975309, -89.739449, 30.965216, -89.748466, 30.949663, -89.740402, 30.925924, -89.75798, 30.920858, -89.745682, 30.909922, -89.746727, 30.902609, -89.763237, 30.900286, -89.765778, 30.861898, -89.78495, 30.861393, -89.774727, 30.830345,-89.796021, 30.828918, -89.796494, 30.812466, -89.81086, 
 30.811512, -89.824615,30.789537, -89.813278, 30.74798, -89.825493, 30.74246, -89.823326, 30.732866, -89.835541, 30.729174, -89.843979, 30.712236, -89.83065, 30.703592, -89.84127, 30.700361, -89.841713, 30.679331, -89.83532, 30.675694, -89.845375, 30.666063, -89.829453, 30.670685, -89.819283, 30.651056, -89.805466, 30.649267, -89.820236, 30.624081, -89.790779, 30.553753, -89.772728, 30.551056, -89.755112, 30.51543, -89.732254, 30.497646, -89.718994, 30.495846, -89.71312, 30.481224, -89.695618, 30.478054, -89.694534, 30.467995, -89.683388, 30.462526, -89.6754, 30.44516, -89.675308, 30.399881, -89.65461, 30.378872, -89.646629, 30.355097, -89.633392, 30.355114, -89.62014, 30.343235, -89.61853, 30.323566, -89.637024, 30.311649, -89.639114, 30.295635, -89.625885, 30.290161, -89.621605, 30.256769, -89.606255, 30.247633, -89.609947, 30.241224, -89.57383, 30.194738, -89.7285, 30.180817, -89.759155, 30.230898, -89.943466, 30.269657, -90.075485, 30.368784, -90.23967, 30.380756,-90.308945, 30.30365, -90.424446, 30.185678, -90.395485, 30.091879, -90.275902,30.061852, -90.111473, 30.041409, -89.990479, 30.053463, -89.891159, 30.155893,-89.798203, 30.105173, -89.740028, 30.158731, -89.724869, 30.120897, -89.669144, 30.163185, -89.649338, 30.122229, -89.716782, 30.055027, -89.8489, 30.010485, -89.820786, 29.951088, -89.714958, 29.969202, -89.712143, 29.897324, -89.627357,29.875475, -89.585808, 29.897953, -89.574326, 30.008759, -89.435806, 30.044205,-89.453575, 29.985531, -89.377747, 29.951084, -89.431, 29.940075, -89.402153, 29.845741, -89.421104, 29.827894, -89.363991, 29.79657, -89.417374, 29.782732, -89.482185, 29.830744, -89.540443, 29.754524, -89.650528, 
 29.766693, -89.592819, 29.710655, -89.611778, 29.697538, -89.511887, 29.664406, -89.479134, 29.635962, -89.597893, 29.664948, -89.676643, 29.702751, -89.695267, 29.693869, -89.635201, 29.62632, -89.728256, 29.645964, -89.748482, 29.637165, -89.723145, 29.605814, -89.771713, 29.610033, -89.544571, 29.47147, -89.537018, 29.401236, -89.384468, 29.397722, -89.337006, 29.340675, -89.264725, 29.350447, -89.262505, 29.29759, -89.193352, 29.348831, -89.12989, 29.290668, -89.120178, 29.211662, -89.033218, 29.223192, -89.098228, 29.163219, -89.021759, 29.146894, -89.057709, 29.085052, -89.126495, 29.135084, -89.111359, 29.08279, -89.153976, 29.05699, -89.144348, 29.016449, -89.241112, 29.120943, -89.257446, 29.059235, -89.394844, 28.939419, -89.263237, 29.147987, -89.319038, 29.179964, -89.339684, 29.104267, -89.388611, 29.100149, -89.393082, 29.146038, -89.467018, 29.216097, -89.459061, 29.255514, -89.493141, 29.234772, -89.61953, 29.279352, -89.610657, 29.331537, -89.794876, 29.322317, -89.753639, 29.374067, -89.821678, 29.420692, -90.934479, 29.258873)));

CREATE OR REPLACE PROCEDURE load_flag IS		
	src_bfile BFILE := BFILENAME('LOUISIANA', 'Louisiana-Flag.jpg');
	dest_blob BLOB;
	BEGIN
		SELECT flag into dest_blob FROM States WHERE Capital = 'Baton Rouge' FOR UPDATE;
		DBMS_LOB.fileopen(src_bfile, DBMS_LOB.LOB_READONLY);
		DBMS_LOB.LoadFromFile( dest_blob,src_bfile,DBMS_LOB.GETLENGTH(src_bfile) );
		DBMS_LOB.fileclose(src_bfile);
		COMMIT;
	END;
/
EXECUTE load_flag;

select * from states;